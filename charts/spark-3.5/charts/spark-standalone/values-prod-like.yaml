# "Prod-like" profile for Minikube/k3s:
# - S3 stays the primary storage (warehouse/event logs/artifacts) via MinIO for tests
# - Spark master HA is enabled via PVC-backed recovery directory
# - PSS hardening is enabled for Spark/Airflow/MLflow/Metastore; embedded Postgres stays relaxed

security:
  podSecurityStandards: true
  postgresql:
    # In real prod you likely use an external DB; for local "prod-like" tests keep embedded DB relaxed.
    relaxed: true

sparkMaster:
  resources:
    requests:
      cpu: "200m"
      memory: "1Gi"
    limits:
      cpu: "1000m"
      memory: "2Gi"
  ha:
    enabled: true
    recoveryDir: "/opt/spark/recovery"
    persistence:
      enabled: true
      size: 1Gi
      storageClass: ""

sparkWorker:
  replicas: 1
  resources:
    requests:
      cpu: "200m"
      memory: "1Gi"
    limits:
      cpu: "1000m"
      memory: "2Gi"

shuffleService:
  enabled: true
  resources:
    requests:
      cpu: "50m"
      memory: "128Mi"
    limits:
      cpu: "300m"
      memory: "512Mi"

minio:
  enabled: true
  resources:
    requests:
      cpu: "50m"
      memory: "256Mi"
    limits:
      cpu: "300m"
      memory: "1Gi"
  persistence:
    enabled: true
    size: 20Gi
    storageClass: ""

hiveMetastore:
  # In real prod this is usually an external service; keep it off for airflow-focused prod-like tests.
  enabled: false

airflow:
  enabled: true
  fernetKey: "ccWYFd6vDiSWvwz1NrFzpUQbexAQ_HiQR5_j_8YkXIA="
  kubernetesExecutor:
    deleteWorkerPods: true
  webserver:
    resources:
      requests:
        cpu: "100m"
        memory: "512Mi"
      limits:
        cpu: "500m"
        memory: "1Gi"
  scheduler:
    resources:
      requests:
        cpu: "100m"
        memory: "512Mi"
      limits:
        cpu: "500m"
        memory: "1Gi"

mlflow:
  enabled: false

