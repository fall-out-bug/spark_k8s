---
ws_id: 00-008-04
feature: F08
status: backlog
size: MEDIUM
project_id: 00
github_issue: null
assignee: null
depends_on:
  - 00-012-01  # History Server template
---

## WS-00-008-04: History Server validation scenarios (32)

### üéØ Goal

**What must WORK after completing this WS:**
- 32 smoke test scenarios validating History Server integration
- Coverage for all components and versions
- Validation of event log collection
- Validation of UI accessibility

**Acceptance Criteria:**
- [ ] AC1: All 32 scenario scripts created
- [ ] AC2: History Server pod starts successfully
- [ ] AC3: Event logs are collected from completed jobs
- [ ] AC4: History UI is accessible and shows job details
- [ ] AC5: All scenarios pass sequentially

**‚ö†Ô∏è WS is NOT complete until Goal is achieved (all AC ‚úÖ).**

---

### Context

History Server (WS-012-01) is complete but lacks integration testing across all scenarios. This WS validates that job history is properly captured.

### Dependencies

- WS-012-01: History Server template

### Input Files

- charts/spark-3.5/templates/history-server.yaml
- charts/spark-4.1/templates/history-server.yaml

### Steps

1. **For each existing scenario:**
   - Add History Server deployment
   - Configure spark.eventLog.enabled=true
   - Configure spark.eventLog.dir pointing to History Server
   - Run sample job
   - Validate job appears in History UI

### Code

```bash
validate_history_server() {
    local hs_pod="$1"
    local ns="$2"
    local app_name="$3"

    # Wait for event logs to be processed
    sleep 30

    # Check UI is accessible
    kubectl exec -n "$ns" "$hs_pod" \
        -- curl -s http://localhost:18080 | grep -q "History Server"

    # Check job appears in history
    kubectl exec -n "$ns" "$hs_pod" \
        -- curl -s "http://localhost:18080/api/v1/applications" \
        | grep -q "$app_name"
}
```

### Scope Estimate

- Files: 32
- Lines: ~1000 (MEDIUM)
- Tokens: ~7500

### Constraints

- DO NOT test with long-running jobs (use pi.py 10)
- DO NOT test scaling (single job validation only)

---

## Execution Report

**Executed by:** ______
**Date:** ______
**Duration:** ______ minutes

### Goal Status
- [ ] AC1-AC5 ‚Äî ‚úÖ

**Goal Achieved:** ______

### Files Changed
| File | Action | LOC |
|------|--------|-----|
|      |        |     |

### Statistics
- **Files Changed:** ______
- **Lines Added:** ______
- **Lines Removed:** ______
- **Test Coverage:** ______ %
- **Tests Passed:** ______
- **Tests Failed:** ______

### Deviations from Plan
- ______

### Commit
______
