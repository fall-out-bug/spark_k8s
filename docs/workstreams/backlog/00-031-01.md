# WS-031-01: Data Ingestion - NYC TLC to MinIO

## Summary
Download NYC TLC trip data (2 years), convert to Parquet, upload to MinIO.

## Scope
- Download yellow taxi trip data 2023-2024 from NYC TLC
- Convert to Parquet format
- Upload to MinIO bucket `nyc-taxi/raw/`
- Create bucket if not exists

## Acceptance Criteria
- [ ] MinIO bucket `nyc-taxi` created
- [ ] ≥24 parquet files uploaded (2 years × 12 months)
- [ ] Data schema matches TLC specification
- [ ] Sample query returns valid results

## Technical Details

### Data Source
```
URL: https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_YYYY-MM.parquet
```

### Schema (TLC Yellow Taxi)
```python
schema = {
    "VendorID": "int64",
    "tpep_pickup_datetime": "timestamp",
    "tpep_dropoff_datetime": "timestamp",
    "passenger_count": "float64",
    "trip_distance": "float64",
    "RatecodeID": "float64",
    "store_and_fwd_flag": "string",
    "PULocationID": "int64",  # Pickup zone
    "DOLocationID": "int64",  # Dropoff zone
    "payment_type": "int64",
    "fare_amount": "float64",
    "extra": "float64",
    "mta_tax": "float64",
    "tip_amount": "float64",
    "tolls_amount": "float64",
    "improvement_surcharge": "float64",
    "total_amount": "float64",
    "congestion_surcharge": "float64",
    "Airport_fee": "float64"
}
```

### Script Location
```
scripts/data_ingestion/download_nyc_tlc.py
```

### Commands
```bash
# Download and upload to MinIO
python scripts/data_ingestion/download_nyc_tlc.py \
  --start-month 2023-01 \
  --end-month 2024-12 \
  --endpoint http://minio.spark-infra.svc.cluster.local:9000 \
  --bucket nyc-taxi \
  --path raw/

# Verify
kubectl exec -n spark-infra deployment/minio -- \
  mc ls local/nyc-taxi/raw/
```

## Dependencies
- MinIO running in spark-infra namespace
- Network access to NYC TLC CDN

## Estimated Complexity
Medium - Network download + format conversion

## Files to Create/Modify
- `scripts/data_ingestion/download_nyc_tlc.py` (new)
- `scripts/data_ingestion/requirements.txt` (new)
