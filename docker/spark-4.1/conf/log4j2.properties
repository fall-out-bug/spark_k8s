# Set root logger level and appenders
rootLogger.level = INFO
rootLogger.appenderRef.stdout.ref = console
# Add JSON appender in production
rootLogger.appenderRef.json.ref = json_console

# Console appender configuration (text format for development)
appender.console.type = Console
appender.console.name = console
appender.console.target = SYSTEM_ERR
appender.console.layout.type = PatternLayout
appender.console.layout.pattern = %d{yy/MM/dd HH:mm:ss} %p %c{1}: %m%n

# JSON Console appender (structured logging for production)
appender.json_console.type = Console
appender.json_console.name = json_console
appender.json_console.target = SYSTEM_OUT
appender.json_console.layout.type = JsonLayout
appender.json_console.layout.compact = true
appender.json_console.layout.eventEol = true
appender.json_console.layout.complete = false
# Add custom fields for better observability
appender.json_console.layout.additionalFields = { "service": "spark-connect", "environment": "${env:SPARK_ENV:-dev}" }

# File appender with JSON layout (for log aggregation)
appender.file_json.type = RollingFile
appender.file_json.name = file_json
appender.file_json.fileName = ${sys:spark.log.dir:-/opt/spark/logs}/spark.log
appender.file_json.filePattern = ${sys:spark.log.dir:-/opt/spark/logs}/spark.log.%i
appender.file_json.layout.type = JsonLayout
appender.file_json.layout.compact = true
appender.file_json.layout.eventEol = true
appender.file_json.layout.complete = false
appender.file_json.layout.additionalFields = { "service": "spark-connect", "environment": "${env:SPARK_ENV:-dev}" }
appender.file_json.policies.type = Policies
appender.file_json.policies.size.type = SizeBasedTriggeringPolicy
appender.file_json.policies.size.size = 100MB
appender.file_json.strategy.type = DefaultRolloverStrategy
appender.file_json.strategy.max = 10

# Spark specific logging
logger.spark.name = org.apache.spark
logger.spark.level = WARN

logger.hadoop.name = org.apache.hadoop
logger.hadoop.level = WARN

logger.hive.name = org.apache.hadoop.hive
logger.hive.level = WARN

# S3A logging
logger.s3a.name = org.apache.hadoop.fs.s3a
logger.s3a.level = WARN

# AWS SDK logging
logger.aws.name = com.amazonaws
logger.aws.level = WARN

logger.awssdk.name = software.amazon.awssdk
logger.awssdk.level = WARN

# Iceberg logging
logger.iceberg.name = org.apache.iceberg
logger.iceberg.level = WARN

# Jetty logging
logger.jetty.name = org.sparkproject.jetty
logger.jetty.level = WARN

# Spark Connect
logger.connect.name = org.apache.spark.sql.connect
logger.connect.level = INFO

# Kafka
logger.kafka.name = org.apache.kafka
logger.kafka.level = WARN

# Audit logging (structured JSON)
logger.audit.name = spark.audit
logger.audit.level = INFO
logger.audit.appenderRef.json_console.ref = json_console
logger.audit.additivity = false
